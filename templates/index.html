<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Healthcare Translation App</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <h1>Healthcare Translation</h1>

    <!-- Language Selection -->
    <label for="inputLanguage">Select Input Language:</label>
    <select id="inputLanguage">
        <option value="en-US">English</option>
        <option value="es">Spanish</option>
        <option value="fr">French</option>
        <!-- Add more languages as needed -->
    </select>

    <label for="outputLanguage">Select Output Language:</label>
    <select id="outputLanguage">
        <option value="es">Spanish</option>
        <option value="fr">French</option>
        <option value="en">English</option>
        <!-- Add more languages as needed -->
    </select>

    <br><br>

    <!-- Button to Start Voice Recognition -->
    <button id="start-btn">Start Recording</button>
    <p id="status"></p>

    <h2>Original Text</h2>
    <p id="original-text">No text spoken yet.</p>

    <h2>Translated Text</h2>
    <p id="translated-text">No translation yet.</p>

    <!-- JavaScript for handling voice recognition and translation -->
    <script>
        const startButton = document.getElementById("start-btn");
        const statusElement = document.getElementById("status");
        const originalTextElement = document.getElementById("original-text");
        const translatedTextElement = document.getElementById("translated-text");
        const inputLanguageElement = document.getElementById("inputLanguage");
        const outputLanguageElement = document.getElementById("outputLanguage");

        // Set up Web Speech API for speech-to-text
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = "en-US";
        recognition.continuous = false;

        // Start recording when button is clicked
        startButton.addEventListener('click', () => {
            recognition.start();
            statusElement.textContent = "Listening...";
        });

        recognition.onresult = async (event) => {
            const spokenText = event.results[0][0].transcript;
            originalTextElement.textContent = `Original Text: ${spokenText}`;

            const inputLanguage = inputLanguageElement.value;
            const outputLanguage = outputLanguageElement.value;

            // Send the spoken text to the backend for translation
            try {
                const response = await fetch('/translate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        text: spokenText,
                        input_language: inputLanguage,
                        output_language: outputLanguage
                    })
                });

                const data = await response.json();
                
                if (data.translated_text) {
                    translatedTextElement.textContent = 'Translated Text: ' + data.translated_text;
                } else {
                    translatedTextElement.textContent = 'Translation failed.';
                }
            } catch (error) {
                console.error('Error during translation:', error);
                translatedTextElement.textContent = 'Error during translation.';
            }
        };

        recognition.onerror = (event) => {
            console.error("Speech recognition error", event.error);
            statusElement.textContent = "Error occurred during speech recognition.";
        };
    </script>

</body>
</html>
